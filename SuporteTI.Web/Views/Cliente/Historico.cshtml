@model IEnumerable<SuporteTI.Web.DTOs.ChamadoReadDto>

@{
    ViewData["Title"] = "Histórico de Chamados";
}

<h2 style="margin-bottom: 20px;">Histórico de Chamados</h2>

@if (!Model.Any())
{
    <p>Você ainda não abriu nenhum chamado.</p>
}
else
{
    <div style="display:flex;flex-direction:column;gap:10px;width:100%;max-width:900px;">

        @foreach (var chamado in Model)
        {
            string corStatus = "#6c757d";
            string corFundo = "#e9ecef";

            switch (chamado.StatusChamado?.ToLower())
            {
                case "aberto":
                    corStatus = "#0d6efd"; // azul
                    corFundo = "#e7f1ff";
                    break;
                case "em andamento":
                    corStatus = "#ff9800"; // laranja
                    corFundo = "#fff3e0";
                    break;
                case "resolvido":
                    corStatus = "#28a745"; // verde
                    corFundo = "#e6f4ea";
                    break;
                case "encerrado":
                    corStatus = "#dc3545"; // vermelho
                    corFundo = "#f8d7da";
                    break;
            }

            <div style="
                        border:1px solid #ccc;
                        border-radius:8px;
                        padding:15px;
                        background-color:#fff;
                        display:flex;
                        justify-content:space-between;
                        align-items:center;
                    ">

                <div style="flex-grow:1;">

                    <!-- TÍTULO COM O ID -->
                    <strong style="font-size:16px;">
                        Chamado #@chamado.IdChamado — @chamado.Titulo
                    </strong>

                    <div style="margin:6px 0;">
                        <span style="
                                        background-color:@corFundo;
                                        color:@corStatus;
                                        padding:4px 10px;
                                        border-radius:6px;
                                        font-size:12px;
                                        font-weight:bold;
                                    ">
                            @chamado.StatusChamado
                        </span>
                    </div>

                    <small style="color:#555;">
                        Aberto em: @chamado.DataAbertura.ToString("dd/MM/yyyy HH:mm")
                    </small>

                </div>

                <!-- BOTÃO VER DETALHES -->
                <a asp-controller="Cliente"
                   asp-action="Chat"
                   asp-route-id="@chamado.IdChamado"
                   style="
                                background-color:#0d6efd;
                                color:white;
                                border:none;
                                border-radius:6px;
                                padding:6px 12px;
                                text-decoration:none;
                                margin-left:12px;
                            ">
                    Ver Detalhes
                </a>

            </div>
        }
    </div>
}
